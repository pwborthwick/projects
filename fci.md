# full configuration interaction and singles and doubles

The essential results of the Slater-Condon rules are:

1.   The full N! terms that arise in the N-electron Slater determinants do not have to be treated explicitly, nor do the N!(N! + 1)/2 Hamiltonian matrix elements among
     the N! terms of one Slater determinant and the N! terms of the same or another Slater determinant
2.   All such matrix elements, for any one- and/or two-electron operator can be expressed in terms of one- or two-electron integrals over the spin-orbitals that appear 
     in the determinants.
3.   The integrals over orbitals are three or six dimensional integrals, regardless of how many electrons N there are.
4.   These integrals over mo's can, through the LCAO-MO expansion, ultimately be expressed in terms of one- and two-electron integrals over the primitive atomic 
     orbitals. It is only these ao-based integrals that can be evaluated explicitly (on high speed computers for all but the smallest systems).

For single excitations:</br>
  <&#916;|&#937;<sub>1</sub>|&#916;<sub>i</sub><sup>j</sup>> = <&#981;<sub>i</sub>|&#937;<sub>1</sub>|&#981;<sub>j</sub>> , where &#937;<sub>n</sub> is an n-body operator</br>
  <&#916;|&#937;<sub>2</sub>|&#916;<sub>i</sub><sup>j</sup>> = &#931; <&#981;<sub>i</sub>&#981;<sub>k</sub>|&#937;<sub>2</sub>|&#981;<sub>j</sub>&#981;<sub>k</sub>>  - <&#981;<sub>i</sub>&#981;<sub>k</sub>|&#937;<sub>2</sub>|&#981;<sub>k</sub>&#981;<sub>j</sub>> 
  
For double excitations:</br>
  <&#916;|&#937;<sub>1</sub>|&#916;<sub>ik</sub><sup>jl</sup>> = 0</br>
  <&#916;|&#937;<sub>2</sub>|&#916;<sub>ik</sub><sup>jl</sup>> = &#931; <&#981;<sub>i</sub>&#981;<sub>k</sub>|&#937;<sub>2</sub>|&#981;<sub>j</sub>&#981;<sub>l</sub>>  - <&#981;<sub>i</sub>&#981;<sub>k</sub>|&#937;<sub>2</sub>|&#981;<sub>l</sub>&#981;<sub>j</sub>> 
  
All higher excitations are 0. The paper states to implement the rules you need</br>
1.  to find the number of spin-orbital substitutions between two determinants
2.  to find  which spin-orbitals are  involved in the substitution
3.  to compute the phase factor if a reordering of the spin-orbitals has occured.

The basis building block of the program is the Slater determinant, this we represent as a spin-seperated pair of tuples of orbital numbers produced by itertools combinations. So for water in STO-3G the ground state determinant would be (0,1,2,3,4) and (0,1,2,3,4). The following routines manipulate the representations of the determinants from class **Determinant**

**indexlist_to_bits** does a conversion of an orbital list to an integer representation. Returns int,

**bits_to_indexlist** converts an integer representation into a list of orbitals.

**get_indexlist** converts the alpha and beta orbital lists to integer representations. Returns int, int.

**count_set_bits** counts the number of '1' bits in an integer representation of an orbital list. Returns int.

**indexlist_to_spin_scattered_indexlist** merges a alpha orbital list and a beta orbital list into a single list. Returns list of orbitals.

**bits_to_spin_scattered_indexlist** converts a pair of integer representations into a spin-scattered orbital list. Returns list of orbitals.

**orbital_positions_in_bit** from an integer representation computes a list of positions of '1' bits. Returns list of positions.

**common_bits** calculates the bits that are set to '1' between two integer representations. Returns list of orbitals, list of orbitals.

**orbital_positions_in_list** for alpha and beta orbitals lists compute the lists of positions of '1' bits. Returns list of positions alpha, list of positions beta.

**common_orbital_in_spin_scattered_indexlist** calculates the bits that are set to '1' between two integer representations of spin-scattered orbital lists. Returns list of orbitals alpha, list of orbitals beta. 

**count_different_orbitals** count the number of different bit settings between alpha and beta orbital lists of two determinants - the excitation between determinants. Return int

**permutation_parity_to_bit_zero** number of swaps of adjacent bits needed to move each set bit to position 0 in both alpha and beta orbital representations (results in ground state). Returns +1 or -1.

**common_bits_and_parity** get the common orbital lists between two determinants and the combined permutation partity. Returns tuple(common determinant 1), tuple(common determinant 2), parity.

**common_bits_and_parity_spin_scattered** as above for spin-scattered determinant orbital lists.

The determinant list generated by the **Determinant** class is processed by the **Hamiltonian** class.

**build_matrix** takes a determinant list and calls routines to evaluate each matrix element. Return np.array.

**evaluate_matrix_element** ensures excitation between two determinants is less than or equal to 2 (Slater-Condon rules) and calls routine for appropriate excitation level. Returns matrix element - float.

**evaluate_zero_excitation** takes single determinant and evaluates one and two-body operators. Returns float

**evaluate_double_excitation** evaluates the one and two-body operators according to the Slater-Condon rules for the two determinants with excitation level of one between them. Returns float.

**evaluate_double_excitation**  evaluates the one and two-body operators according to the Slater-Condon rules for the two determinants with excitation level of two between them. Returns float.


The **CI** clase forms a wrapper around **Determinant** and **Hamiltonian** classes. The **CI** class should be constructed with arguements (Fock matrix, 2-electron repulsion integrals, number of basis functions, double occupied orbitals). All in spatial orbitals. Then the **CI** class mathod **FCI** is called with arguement level which can be 'S', 'D'. 'T', 'Q', 'P', 'H' or 'F' for singles, doubles, triples, quadruples, etc up to full CI.

Results for $H_2 O$ in STO-3G are 
```
Full Configuration Interaction
------------------------------
number of electrons 10
number of spin orbitals 14
number of determinants  441
SCF energy  -74.942080
FCI energy  -75.012980
FCI correction  -0.070900

CIS                                     *note this is spin-adapted so triplets are only reported once.
------------------------------
number of electrons 10
number of spin orbitals 14
number of determinants  20
 7.816620    9.372282    9.699819    9.959068   10.735267   11.321889
13.758846   13.994543   15.107540   15.321527   17.832123   24.765672

CISD
------------------------------
number of electrons 10
number of spin orbitals 14
number of determinants  141
SCF energy  -74.942080
CISD energy -75.011223
CISD correction -0.069143
```

